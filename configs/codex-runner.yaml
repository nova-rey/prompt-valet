# codex-runner.yaml
# Config for Codex watcher + inbox tree builder.

tree_builder:
  # When true, also pre-create inbox folders for all repos/branches
  # (the "spicy mode" toggle). When false, only repos that already
  # have an inbox root under /srv/copyparty/inbox/ are considered.
  greedy_inboxes: false

  # Branch selection mode for building inbox/<repo>/<branch> trees.
  #
  #   "all"        = include every branch from `git branch --format '%(refname:short)'`
  #   "whitelist"  = only branches listed in branch_whitelist
  #   "blacklist"  = all branches except those in branch_blacklist
  #   "both"       = only branches in branch_whitelist, minus any in branch_blacklist
  #
  # Right now the script still uses its older PROTECTED_BRANCHES list,
  # but this key is here so we can wire it up cleanly next pass.
  branch_mode: "all"

  # Explicitly allowed branches (used when branch_mode is "whitelist" or "both").
  branch_whitelist: []

  # Explicitly blocked branches (used when branch_mode is "blacklist" or "both").
  branch_blacklist: []

  # Placeholder for when/if we turn the tree-builder into a looped daemon.
  # Right now the script just runs once, but this keeps the setting in
  # one canonical place.
  scan_interval_seconds: 60

watcher:
  # If true, missing repos under /srv/repos/<repo> will be auto-cloned
  # when a prompt arrives in inbox/<repo>/<branch>/...prompt.md
  auto_clone_missing_repos: true

  # Your Git hosting identity.
  git_default_owner: "owner"
  git_default_host: "github.com"

  # "https" is easy for public repos; "ssh" uses your SSH keys.
  git_protocol: "https"

  # If true and /srv/repos/<repo> exists but is NOT a git repo
  # (no .git directory), the watcher will delete it and re-clone
  # from the remote. If false, it will refuse to touch the directory.
  cleanup_non_git_dirs: true
