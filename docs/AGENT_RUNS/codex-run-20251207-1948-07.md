- `install_prompt_valet.sh#L21-L167`: introduced `CONFIG_PATH`/`COPYPARTY_CONFIG_PATH` defaults and rewrote `write_prompt_valet_config` so it runs a Python heredoc that builds a proper YAML tree from the installerâ€™s environment variables, dumps it with `yaml.safe_dump(sort_keys=False)`, and only writes when not in DRY RUN; the heredoc now feeds Python and redirects its stdout into the config file instead of reading from it.
- `install_prompt_valet.sh#L169-L194`: reimplemented `write_copyparty_config` to emit the documented `service` YAML via `cat > "$COPYPARTY_CONFIG_PATH"` when `PV_FILE_SERVER_MODE` is `copyparty`, to log DRY-RUN suppression, and to remove the file otherwise, so no heredoc is misrouted and the removal path respects DRY RUN.
- Tests: `bash -n install_prompt_valet.sh` (pass).